#include "utils.h"
#include "../mGB.h"

uint8_t bkg[20] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
uint8_t currentScreen;

// TODO: generate from png
const uint8_t data_barrow[16] = {0x00, 0x00, 0xE7, 0xE7, 0x7E, 0x7E,
                                 0x3C, 0x3C, 0x18, 0x18, 0x00, 0x00,
                                 0x00, 0x00, 0x00, 0x00};

// TODO: generate from png
const uint8_t data_larrow[16] = {0xC0, 0xC0, 0xE0, 0xE0, 0x70, 0x70,
                                 0xE0, 0xE0, 0xC0, 0xC0, 0x00, 0x00,
                                 0x00, 0x00, 0x00, 0x00};

// TODO: generate from png
const uint8_t data_font[] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0xFC, 0xFC, 0xC6, 0xC6, 0xE6, 0xE6, 0xD6, 0xD6,
    0xCE, 0xCE, 0xC6, 0xC6, 0x7E, 0x7E, 0x00, 0x00, 0x38, 0x38, 0x18, 0x18,
    0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x08, 0x08, 0x00, 0x00,
    0xFC, 0xFC, 0x06, 0x06, 0x06, 0x06, 0xFE, 0xFE, 0xC0, 0xC0, 0xC0, 0xC0,
    0x7C, 0x7C, 0x00, 0x00, 0xFC, 0xFC, 0x06, 0x06, 0x06, 0x06, 0x3E, 0x3E,
    0x06, 0x06, 0x06, 0x06, 0xFC, 0xFC, 0x00, 0x00, 0xC6, 0xC6, 0xC6, 0xC6,
    0xC6, 0xC6, 0x7E, 0x7E, 0x06, 0x06, 0x06, 0x06, 0x02, 0x02, 0x00, 0x00,
    0xFE, 0xFE, 0xC0, 0xC0, 0xC0, 0xC0, 0xFE, 0xFE, 0x06, 0x06, 0x06, 0x06,
    0xFE, 0xFE, 0x00, 0x00, 0x7E, 0x7E, 0xC0, 0xC0, 0xFE, 0xFE, 0xC6, 0xC6,
    0xC6, 0xC6, 0xC6, 0xC6, 0xFC, 0xFC, 0x00, 0x00, 0xFE, 0xFE, 0x06, 0x06,
    0x0E, 0x0E, 0x1C, 0x1C, 0x18, 0x18, 0x18, 0x18, 0x08, 0x08, 0x00, 0x00,
    0xFC, 0xFC, 0xC6, 0xC6, 0xC6, 0xC6, 0xFE, 0xFE, 0xC6, 0xC6, 0xC6, 0xC6,
    0x7E, 0x7E, 0x00, 0x00, 0xFC, 0xFC, 0xC6, 0xC6, 0xC6, 0xC6, 0xFE, 0xFE,
    0x06, 0x06, 0x06, 0x06, 0x0C, 0x0C, 0x00, 0x00, 0x7E, 0x7E, 0xC6, 0xC6,
    0xFE, 0xFE, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0x82, 0x82, 0x00, 0x00,
    0xFC, 0xFC, 0xC6, 0xC6, 0xFC, 0xFC, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6,
    0xFC, 0xFC, 0x00, 0x00, 0x7E, 0x7E, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0,
    0xC0, 0xC0, 0xC0, 0xC0, 0x7E, 0x7E, 0x00, 0x00, 0xF8, 0xF8, 0xC6, 0xC6,
    0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xF8, 0xF8, 0x00, 0x00,
    0x7E, 0x7E, 0xC0, 0xC0, 0xC0, 0xC0, 0xF8, 0xF8, 0xC0, 0xC0, 0xC0, 0xC0,
    0x7E, 0x7E, 0x00, 0x00, 0x7E, 0x7E, 0xC0, 0xC0, 0xC0, 0xC0, 0xF8, 0xF8,
    0xC0, 0xC0, 0xC0, 0xC0, 0x40, 0x40, 0x00, 0x00, 0x7C, 0x7C, 0xC0, 0xC0,
    0xCE, 0xCE, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0x7C, 0x7C, 0x00, 0x00,
    0xC4, 0xC4, 0xC6, 0xC6, 0xFE, 0xFE, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6,
    0x46, 0x46, 0x00, 0x00, 0xFE, 0xFE, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
    0x30, 0x30, 0x30, 0x30, 0xFE, 0xFE, 0x00, 0x00, 0x06, 0x06, 0x06, 0x06,
    0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0xFC, 0xFC, 0x00, 0x00,
    0xC6, 0xC6, 0xCC, 0xCC, 0xF8, 0xF8, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6,
    0x46, 0x46, 0x00, 0x00, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0,
    0xC0, 0xC0, 0xC0, 0xC0, 0x7E, 0x7E, 0x00, 0x00, 0xC6, 0xC6, 0xEE, 0xEE,
    0xD6, 0xD6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0x82, 0x82, 0x00, 0x00,
    0xFC, 0xFC, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6,
    0x82, 0x82, 0x00, 0x00, 0x7C, 0x7C, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6,
    0xC6, 0xC6, 0xC6, 0xC6, 0x7C, 0x7C, 0x00, 0x00, 0x7E, 0x7E, 0xC6, 0xC6,
    0xC6, 0xC6, 0xC6, 0xC6, 0xFC, 0xFC, 0xC0, 0xC0, 0x40, 0x40, 0x00, 0x00,
    0x7E, 0x7E, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0x7E, 0x7E, 0x06, 0x06,
    0x06, 0x06, 0x00, 0x00, 0xFE, 0xFE, 0xC6, 0xC6, 0xC6, 0xC6, 0xF8, 0xF8,
    0xC6, 0xC6, 0xC6, 0xC6, 0x46, 0x46, 0x00, 0x00, 0x7E, 0x7E, 0xC0, 0xC0,
    0xC0, 0xC0, 0x7C, 0x7C, 0x06, 0x06, 0x06, 0x06, 0xFC, 0xFC, 0x00, 0x00,
    0xFE, 0xFE, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
    0x08, 0x08, 0x00, 0x00, 0x46, 0x46, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6,
    0xC6, 0xC6, 0xC6, 0xC6, 0xFC, 0xFC, 0x00, 0x00, 0x82, 0x82, 0xC6, 0xC6,
    0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0x6C, 0x6C, 0x10, 0x10, 0x00, 0x00,
    0x82, 0x82, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xC6, 0xD6, 0xD6, 0xEE, 0xEE,
    0x44, 0x44, 0x00, 0x00, 0xC6, 0xC6, 0xEE, 0xEE, 0x6C, 0x6C, 0x38, 0x38,
    0x6C, 0x6C, 0xEE, 0xEE, 0xC6, 0xC6, 0x00, 0x00, 0xC6, 0xC6, 0xC6, 0xC6,
    0xC6, 0xC6, 0x7E, 0x7E, 0x0C, 0x0C, 0x18, 0x18, 0x30, 0x30, 0x00, 0x00,
    0xFE, 0xFE, 0x0E, 0x0E, 0x1C, 0x1C, 0x38, 0x38, 0x70, 0x70, 0xE0, 0xE0,
    0xFE, 0xFE, 0x00, 0x00, 0x82, 0x82, 0x44, 0x44, 0x28, 0x28, 0x10, 0x10,
    0x28, 0x28, 0x44, 0x44, 0x82, 0x82, 0x00, 0x00, 0x00, 0x00, 0x38, 0x38,
    0x7C, 0x7C, 0x7C, 0x7C, 0x7C, 0x7C, 0x38, 0x38, 0x00, 0x00, 0x00, 0x00,
    0x08, 0x08, 0x14, 0x14, 0x22, 0x22, 0x41, 0x41, 0x80, 0x80, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x24, 0x24, 0x24, 0x24, 0x42, 0x42,
    0x81, 0x81, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x0C, 0x14, 0x14,
    0x24, 0x24, 0x44, 0x44, 0x87, 0x87, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x03, 0x03, 0x0D, 0x0D, 0x31, 0x31, 0xC1, 0xC1, 0x01, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
    0x80, 0x80, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xC0,
    0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x7F, 0x7F, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0xE0, 0xE0, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3F, 0x3F,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 0xF0, 0x10, 0x10, 0x10, 0x10,
    0x10, 0x10, 0x1F, 0x1F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFC, 0xFC,
    0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x07, 0x07, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x90, 0x90, 0x0D, 0x0D, 0x42, 0x42, 0xA9, 0xA9, 0x04, 0x04,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80,
    0x80, 0x80, 0xFF, 0xFF, 0x7F, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80,
    0x80, 0x80, 0x80, 0x80, 0xC0, 0xC0, 0xFF, 0xFF, 0x7F, 0x7F, 0x00, 0x00,
    0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0xC0, 0xC0, 0xE0, 0xE0, 0xFF, 0xFF,
    0x7F, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0xC0, 0xC0, 0xE0, 0xE0,
    0xF0, 0xF0, 0xFF, 0xFF, 0x7F, 0x7F, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xC0,
    0xF0, 0xF0, 0xF8, 0xF8, 0xFC, 0xFC, 0xFF, 0xFF, 0x7F, 0x7F, 0x00, 0x00,
    0x00, 0x00, 0xF0, 0xF0, 0xF8, 0xF8, 0xFC, 0xFC, 0xFE, 0xFE, 0xFF, 0xFF,
    0x7F, 0x7F, 0x00, 0x00, 0x00, 0x00, 0xFC, 0xFC, 0xFE, 0xFE, 0xFF, 0xFF,
    0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0x7F, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF,
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0x7F, 0x00, 0x00,
    0x00, 0x00, 0x3F, 0x3F, 0x7F, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
    0xFE, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x1F, 0x3F, 0x3F, 0x7F, 0x7F,
    0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F,
    0x3F, 0x3F, 0x7F, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xFE, 0x00, 0x00,
    0x00, 0x00, 0x07, 0x07, 0x1F, 0x1F, 0x3F, 0x3F, 0x7F, 0x7F, 0xFF, 0xFF,
    0xFE, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x0F, 0x0F, 0x3F, 0x3F,
    0x7F, 0x7F, 0xFF, 0xFF, 0xFE, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01,
    0x03, 0x03, 0x0F, 0x0F, 0x3F, 0x3F, 0xFF, 0xFF, 0xFE, 0xFE, 0x00, 0x00,
    0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x07, 0x07, 0x1F, 0x1F, 0xFF, 0xFF,
    0xFE, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x10, 0x38, 0x38,
    0x6C, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x6C, 0x6C, 0x38, 0x38, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x70, 0x00, 0x18, 0x00, 0x18, 0x00, 0x18, 0x00, 0x18, 0x00, 0x18,
    0x00, 0x08, 0x00, 0x00, 0x00, 0xFC, 0x00, 0x06, 0x00, 0x06, 0x00, 0xFE,
    0x00, 0xC0, 0x00, 0xC0, 0x00, 0x7E, 0x00, 0x00, 0x00, 0xFC, 0x00, 0x06,
    0x00, 0x06, 0x00, 0x3E, 0x00, 0x06, 0x00, 0x06, 0x00, 0xFC, 0x00, 0x00,
    0x00, 0xC6, 0x00, 0xC6, 0x00, 0xC6, 0x00, 0x7E, 0x00, 0x06, 0x00, 0x06,
    0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x03, 0x03, 0x04, 0x04, 0x05, 0x05, 0xF3, 0xF3, 0xAB, 0xAB,
    0xAB, 0xAB, 0x89, 0x89, 0x04, 0x04, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF,
    0x00, 0x00, 0xEF, 0xEF, 0x0C, 0x0C, 0x7F, 0x7F, 0x0C, 0x0C, 0xFF, 0xFF,
    0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xC0, 0x20, 0x20, 0x90, 0x90,
    0xD1, 0xD1, 0xD1, 0xD1, 0xD0, 0xD0, 0x90, 0x90, 0x20, 0x20, 0xC0, 0xC0,
    0x00, 0x00, 0x00, 0x00, 0xB4, 0xB4, 0xF7, 0xF7, 0xE4, 0xE4, 0x44, 0x44,
    0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x76, 0x76, 0x55, 0x55,
    0x67, 0x67, 0x55, 0x55, 0x11, 0x11, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x75, 0x75, 0x45, 0x45, 0x77, 0x77, 0x15, 0x15, 0x31, 0x31, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x77, 0x77, 0x05, 0x05, 0x77, 0x77, 0x05, 0x05,
    0x77, 0x77, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x70, 0x70, 0x50, 0x50,
    0x50, 0x50, 0x50, 0x50, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18,
    0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x70, 0x70, 0xF8, 0xF8, 0xF8, 0xF8,
    0xF8, 0xF8, 0x70, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x50, 0x50, 0x20, 0x20, 0x50, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 0x00, 0xF0, 0x00, 0xF0, 0x00, 0xF0,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x00, 0x0F,
    0x00, 0x0F, 0x00, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 0x00, 0xF0,
    0x00, 0xF0, 0x00, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x0F, 0x00, 0x0F, 0x00, 0x0F, 0x00, 0x0F, 0x00, 0xFF, 0x00, 0xFF,
    0x00, 0xFF, 0x00, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x00, 0xFF,
    0x00, 0xFF, 0x00, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0xD8, 0x00, 0x70,
    0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

const uint16_t bgpalette[] = {RGB_BLACK, RGB_BLACK, RGB_HAWT, RGB_WHITE};

const uint16_t spritepalette[] = {RGB_WHITE, RGB_LIGHTGRAY, RGB_LIGHTGRAY,
                                  RGB_BLACK, RGB_HAWT,      RGB_HAWT,
                                  RGB_HAWT,  RGB_HAWT};

void cls(void) {
  for (j = 0; j != 20; j++)
    bkg[j] = 0x00U;
  for (j = 0; j != 18; j++) {
    set_bkg_tiles(0, j, 20, 1, bkg);
  }
}

void hideCursor(void) {
  for (j = 0; j != 4; j++) {
    move_sprite(j + SPRITE_ARRL_START, 0, 0);
  }
  move_sprite(SPRITE_ARRT_START, 0, 0);
}

void displaySetup(void) {
  DISPLAY_OFF;
  set_bkg_palette(0, 1, &bgpalette[0]);

  /* Initialize the background */
  set_bkg_data(0, 92, data_font);
  // set_bkg_tiles(1,0, 20, 18, bgmap);

  set_sprite_palette(0, 2, &spritepalette[0]);

  SPRITES_8x8;

  set_sprite_data(SPRITE_ARRT, 0x01U, data_barrow);
  set_sprite_data(SPRITE_ARRL, 0x01U, data_larrow);

  set_sprite_tile(SPRITE_ARRT_START, SPRITE_ARRT);
  for (j = 0; j != 4; j++)
    set_sprite_tile(j + SPRITE_ARRL_START, SPRITE_ARRL);

  for (j = 0; j != 4; j++)
    set_sprite_prop(j + SPRITE_ARRT_START, 1);
  for (j = 0; j != 4; j++)
    set_sprite_prop(j + SPRITE_ARRL_START, 1);

  DISPLAY_ON;

  SHOW_BKG;
  SHOW_SPRITES;
}
